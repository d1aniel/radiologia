<div class="mx-auto w-full max-w-[880px] rounded-xl bg-white p-4 sm:p-6 shadow-sm">
  <h2 class="mb-4 text-lg font-semibold text-slate-800">Agregar Estudio</h2>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="grid grid-cols-12 gap-3">

    <!-- Paciente -->
    <div class="col-span-12 md:col-span-6">
      <label class="block mb-1 text-sm font-medium text-slate-700">Paciente</label>
      <input pInputText formControlName="paciente" class="w-full text-sm px-3 py-2" placeholder="Nombre del paciente"/>
      <small class="text-red-600 text-xs" *ngIf="f['paciente'].touched && f['paciente'].invalid">Requerido.</small>
    </div>

    <!-- Modalidad -->
    <div class="col-span-12 md:col-span-3">
      <label class="block mb-1 text-sm font-medium text-slate-700">Modalidad</label>
      <input pInputText formControlName="modalidad" class="w-full text-sm px-3 py-2" placeholder="RX / TAC / RM"/>
      <small class="text-red-600 text-xs" *ngIf="f['modalidad'].touched && f['modalidad'].invalid">Requerido.</small>
    </div>

    <!-- Equipo -->
    <div class="col-span-12 md:col-span-3">
      <label class="block mb-1 text-sm font-medium text-slate-700">Equipo</label>
      <input pInputText formControlName="equipo" class="w-full text-sm px-3 py-2" placeholder="Ej. RX-01 Sala A"/>
      <small class="text-red-600 text-xs" *ngIf="f['equipo'].touched && f['equipo'].invalid">Requerido.</small>
    </div>

    <!-- Fecha/Hora (DatePicker) -->
    <div class="col-span-12 md:col-span-4">
      <label class="block mb-1 text-sm font-medium text-slate-700">Fecha/Hora</label>
      <p-datepicker
        formControlName="fechaHora"
        [showTime]="true"
        hourFormat="24"
        [iconDisplay]="'input'"
        appendTo="body"
        class="w-full">
      </p-datepicker>
      <small class="text-red-600 text-xs" *ngIf="f['fechaHora'].touched && f['fechaHora'].invalid">Requerido.</small>
    </div>

    <!-- Prioridad -->
    <div class="col-span-12 md:col-span-4">
      <label class="block mb-1 text-sm font-medium text-slate-700">Prioridad</label>
      <p-select formControlName="prioridad" [options]="prioridades" optionLabel="label" optionValue="value" class="w-full text-sm"></p-select>
    </div>

    <!-- Tecnólogo -->
    <div class="col-span-12 md:col-span-4">
      <label class="block mb-1 text-sm font-medium text-slate-700">Tecnólogo asignado</label>
      <input pInputText formControlName="tecnologo" class="w-full text-sm px-3 py-2" placeholder="Nombre del tecnólogo"/>
      <small class="text-red-600 text-xs" *ngIf="f['tecnologo'].touched && f['tecnologo'].invalid">Requerido.</small>
    </div>

    <!-- Médico -->
    <div class="col-span-12 md:col-span-6">
      <label class="block mb-1 text-sm font-medium text-slate-700">Médico radiólogo</label>
      <input pInputText formControlName="medico" class="w-full text-sm px-3 py-2" placeholder="Nombre del médico"/>
      <small class="text-red-600 text-xs" *ngIf="f['medico'].touched && f['medico'].invalid">Requerido.</small>
    </div>

    <!-- Motivo / Indicación clínica -->
    <div class="col-span-12">
      <label class="block mb-1 text-sm font-medium text-slate-700">Motivo / Indicación clínica</label>
      <input pInputText formControlName="motivo" class="w-full text-sm px-3 py-2" placeholder="Describe brevemente la indicación clínica"/>
      <small class="text-red-600 text-xs" *ngIf="f['motivo'].touched && f['motivo'].invalid">Mínimo 5 caracteres.</small>
    </div>

    <!-- Etiquetas (AutoComplete multiple) -->
    <div class="col-span-12">
      <label class="block mb-1 text-sm font-medium text-slate-700">Etiquetas</label>

      <!-- permite escribir etiquetas nuevas -->
      <p-autocomplete
        formControlName="etiquetas"
        [multiple]="true"
        [dropdown]="true"
        [suggestions]="filteredEtiquetas"
        (completeMethod)="filterEtiquetas($event)"
        [forceSelection]="false"
        placeholder="Escribe para buscar o agrega nuevas (Enter)"
        class="w-full">
      </p-autocomplete>

      <small class="text-slate-500 text-xs">Ejemplos: Columna, Trauma, Urgente</small>
    </div>

    <!-- Acciones -->
    <div class="col-span-12">
      <div class="mt-3 flex items-center justify-end gap-2">
        <p-button label="Cancelar" severity="secondary" [size]="'small'" (onClick)="onCancel()" type="button"></p-button>
        <p-button label="Guardar" icon="pi pi-check" [size]="'small'" type="submit" [disabled]="form.invalid"></p-button>
      </div>
    </div>

  </form>
</div>
